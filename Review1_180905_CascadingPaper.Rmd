---
title: "Cascading regime shifts within and across scales"
author: |
    | Juan C. Rocha^1,2^, Garry Peterson^1^, Örjan Bodin^1^, Simon A. Levin^3^
    | \small ^1^Stockholm Resilience Centre, Stockholm University, Kräftriket 2B, 10691 Stockholm
    | \small ^2^Beijer Institute, Swedish Royal Academy of Sciences, Lilla Frescativägen 4A, 104 05 Stockholm
    | \small ^3^Department of Ecology & Evolutionary Biology, Princeton University, 106A Guyot Hall, Princeton, NJ 08544-1003

output:
  word_document:
    toc: no
  pdf_document:
    dev: pdf
    keep_tex: yes
    latex_engine: pdflatex
    toc: no
  html_document:
    df_print: paged
    toc: no
citecolor: blue
csl: science.csl
documentclass: article
fontsize: 9pt
header-includes:
- \usepackage{dcolumn}
- \usepackage[T1]{fontenc}
- \usepackage{inputenc}
keywords: regime shifts, cascading effects, tele-connections, coupled critical transitions,
  networks
lineno: no
linkcolor: blue
bibliography: cascading.bib
abstract: |
  Regime shifts are large, abrupt and persistent critical transitions in the function and structure of ecosystems. Yet it is unknown how these transitions will interact, whether the occurrence of one will increase the likelihood of another, or simply correlate at distant places. Here we explore two types of cascading effects: domino effects create one-way dependencies, while hidden feedbacks produce two-way interactions. We compare them with the control case of driver sharing which can induce correlations. Using 30 regime shifts described as networks, we show that 45% of regime shift pairwise combinations present at least one plausible structural interdependence. The likelihood of cascading effects depends on cross-scale interactions, but differs for each cascading effect type. Management of regime shifts should account for potential connections.

urlcolor: blue
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, dev = "pdf", dpi = 300)
options(knitr.table.format = "latex")
options(tinytex.verbose = TRUE)

## This draft version contains the latest additions by Garry.

rm(list = ls())
set.seed(12345)
library(knitr)
library (dplyr)
library (tidyr)
library(forcats)
library (network)
library (sna)
library(RColorBrewer)
library(ggplot2)
library(GGally)
library(viridis)
library(ggrepel)

# for plotting
library(ggmap)
library(maptools)
library(maps)
library(mapproj)

library(gridBase)
library(grid)
library(gridExtra)
library(png)


## for cleaning models
library(car)
library(broom)
library(sandwich); library(lmtest)

### ERGMS for Regime Shifts
library(ergm.count)

## for tables
library(kableExtra)

# setwd('~/Documents/Projects/Cascading Effects/Domino')
# Sys.setenv(RSTUDIO_PANDOC="/Applications/RStudio.app/Contents/MacOS/pandoc")
# rmarkdown::render('170125_draft.Rmd', output_format = 'pdf_document')

  # html_document:
  #   code_folding: hide
  #   dev: pdf
  #   self_contained: yes
  #   toc: yes
  #   toc_float:
  #     collapsed: no
  #     smooth_scroll: no
  # word_document: null

# - \usepackage{lineno}
# - \linenumbers


```


```{r data_ergm, include=FALSE}
# this loads the data, it was cleaned and prepared with script 170329_read_data.R
# and load the ergm models fitted with script 170329_ergms.R

load('~/Documents/Projects/Cascading Effects/170525_ergm_data.RData')


## updated functions ##
## this can be deleted in the future

## Updated ploting function
plotnet <- function(net, ...){
	plot.network(net, #mode='circle',
			vertex.col = alpha(net %v% 'col', 0.7),
			# label = network.vertex.names(net),
			# label.cex= 1,
			main = net %n% 'name', col.main = "gray44", cex.main = 1.2,
			vertex.border = 0,
			usecurve=T,
			vertex.cex= 2, #2 + scale(net %v% 'fb'),
			label.pos= 5,
			edge.col= alpha(net %e% 'col' , 1),
			edge.lwd =  rep(0.01, max(valid.eids(net))), #0.05 + net %e% 'fb',
			edge.curve = 0.01,
			displayisolates=T, pad = 0
			)
}

plotnet2 <- function(net, ...){
	plot.network(net, #mode='circle',
			vertex.col = alpha(net %v% 'col', 0.7),
			# label = network.vertex.names(net),
			# label.cex= 1,
			main = net %n% 'name', col.main = "gray44", cex.main = 1.2,
			vertex.border = 0,
			usecurve=T,
			vertex.cex= 2 + scale(net %v% 'fb'),
			label.pos= 5,
			edge.col= alpha(net %e% 'col' , 1),
			edge.lwd =  0.01 * net %e% 'fb',
			edge.curve = 0.01,
			displayisolates=T, pad = 0 # no need of pad for labels
			)
		}
## A function to create the network, add polarity and cycles / feedbacks as edge attributes
## J161105: Edge attributes are tricky to set because once the network is created the ordering of edges is lost and I cannot find the default order to set the right values. Reading the help of 'loading.attributes' I found that when declared as edgelist one can add attributes directly on the dataframe.
rs.net <- function (dat, i){
	# filter dataset
	dat <- filter(dat, Regime.Shift == levels(dat$Regime.Shift)[i],
	 Polarity == 1 | Polarity == -1)
	#dat <- droplevels(dat)
	# This ordering step is necessary to make sure polarity and other attributes are assigned correctly
	# dat <- dat[order(dat$Tail, partial = dat$Head, decreasing = F),]
	# tab <- table(dat$Tail, dat$Head, dat$Polarity) # tab is an array of tables
		# dimnames(tab) [[3]] "-1"   "-0.5" "0.5"  "1"
		# v <- as.matrix(tab[,,1]*-1) + as.matrix(tab[,,2])
	# build network
		rs.x <- network(select(dat, Tail, Head, Polarity, col), directed = T, ignore.eval=FALSE, matrix.type = 'edgelist')
	# add polarity to edges: Outated, the way I create the network includes already the polarities by using ignore.eval = F. Edge color is also set on the network creation line.
		# rs.x %e% 'polarity' <- dat$Polarity
		# set.edge.value(rs.x, 'polarity', value = as.matrix(v))
		# rs.x %e% 'col' <- ifelse(rs.x %e% "Polarity" == -1, 'red', 'blue')
	# add cycles to nodes and edges.
		fb.sum <- kcycle.census(rs.x, maxlen=network.size(rs.x), mode='digraph',	tabulate.by.vertex=T, cycle.comembership='sum')
		# number of cycles per nodes
		rs.x %v% 'fb' <-  diag(fb.sum$cycle.comemb)
		# number of cycles per edge
		rs.x %e% 'fb' <- as.sociomatrix(rs.x) * fb.sum$cycle.comemb
		#J161106: Note that cycle.comemb is a matrix with comemberships, so two nodes that are not connected in the network can belong to the same cycles. That's why I multiply by the adjacency matrix, to isolate only the edges. cycle.comemb can be used later for discovery of inconvenient feedbacks.
	## add vertex attributes
		rs.x %v% 'col' <- ifelse(colSums(fb.sum$cycle.count)[-1] == 0, "#E41A1C","#8DA0CB") # "#FFD92F"
		rs.x %n% 'name' <- levels(dat$Regime.Shift)[i]
	return(rs.x)
}

```

**Abrupt changes in ecosystems can be connected to others in time and space**

## Introduction

Regime shifts occur across a wide range of social-ecological systems  [@Scheffer:2003p339; @Scheffer:2001uu; @Biggs:2018hx], they are hard to predict and difficult to reverse [@Boettiger:2013bm; @Hastings:2010p5336], while producing long term shifts in the availability of ecosystems services [@Carpenter:2009jr]. A regime shift means that a system has moved from one stability domain to another, implying a shift from one set of dominating processes and structures to another set [@MAY:1977p3426; @Holling:1973p6861; @Scheffer:2001uu; @Anonymous:2004bq]. Changes in a key variable (e.g. temperature in coral reefs) often make a system more susceptible to shifting regimes when exposed to shock events (e.g. hurricanes) or the action of external drivers (such as fishing) [@Scheffer:2012cta]. Over 30 different regime shifts in social-ecological systems have been documented [@Biggs:2018hx], and similar non-linear dynamics are seen across societies, finance, language, neurological diseases, or climate [@Sole:2011us; @Scheffer:2009wl]. As humans increase their pressure on the planet, regime shifts are likely to occur more often and severely [@Rocha:2015du].

An emergent challenge for science and practice is that regime shifts can potentially lead to subsequent regime shifts. We define a cascading regime shift when its occurrence may affect the occurrence of another regime shift. A variety of connections between regime shifts have been identified (See Table S1). For example, eutrophication is often reported as a regime shift preceding hypoxia or dead zones in coastal areas [@Diaz:2008p199]. Similarly, hypoxic events have been reported to affect the resilience of coral reefs to warming and other stressors in the tropics [@Altieri:2017bl]. If, why, and how a regime shift somewhere in the world could affect the occurrence of another regime shift remains largely open questions and a key frontier of research  [@Liu:2015go; @Hughes:2013cv].

Research on regime shifts is often confined to well-defined branches of science, reflecting empirical, theoretical [@Carpenter2003rsi] or predictive approaches [@Scheffer:2012cta; @Scheffer:2009p4449]. These approaches require a deep knowledge of the causal structure of the system or a high quality of spatio-temporal data. Hence research on regime shifts has generally focused on the analysis of individual types of regime shifts rather than potential interactions across systems. This paper takes another approach and instead explores potential interactions among a large set of regime shifts. We investigate two types of interconnections: domino effects and hidden feedbacks. Domino effects occur when the feedback processes of one regime shift affects the drivers of another regime shift, creating a one-way dependency [@Rocha:2010vv; @Hughes:2013cv; @Scheffer:2012cta]. A feedback mechanism is a self-amplifying or dampening process characterized by a pathway of causal processes that return to its origin creating a cycle. Two-way interactions rise when two regime shifts combined generate new feedbacks that cannot be identified on the separated regime shifts [@Liu:2015go; @Rocha:2010vv]; and if strong enough, they could amplify or dampen the coupled dynamics. We call them hidden feedbacks because they only show when two regime shift networks are combined. We contrast these cascading effects, in which the occurrence of a regime shift give rise to subsequent regime shifts, with the potentially multiplying albeit different effect of two regime shifts being caused by common drivers. Driver sharing is likely to increase correlation in time or space among regime shifts, but not necessarily interdependence [@Hughes:2013cv; @Rocha:2015du].

## Hypotheses of cascading effects

When analyzing individual regime shifts, bifurcation theory often treats drivers as slow variables, which assumes that their change are relatively slower than changes in variables that describe the state of the system [@Crepin:2006ex; @Kuznetsov:2004vv]. Recursively, when analyzing pairs of regime shifts, we first expect that domino effects will be dominated by connections from regime shifts occurring at larger spatial scales and slower temporal dynamics than regime shifts receiving the connection [@Dekker:2018jk]. Secondly, hidden feedbacks are expected to occur when scales match in space and time, because for a new feedback to emerge, regime shifts need to be somewhat aligned in the scale at which their process operate. Thirdly, regime shifts occurring in similar ecosystem types or land uses will be subject to relatively similar sets of drivers, thus we expect driver sharing to be context specific [@Hughes:2013cv; @Rocha:2015du].

The three hypotheses were tested by analyzing regime shifts as networks of drivers and feedback processes. These directed signed graphs allow us to explore driver co-occurrence, directional pathways and emergent feedback cycles of coupled regime shift networks (Fig. 1 and SM Methods for a worked example). The empirical basis for our investigation draws from the [regime shifts database](www.regimeshifts.org)[@Biggs:2018hx] (Fig S1, S2); which offers syntheses of over $30$ types of regime shifts and $> 300$ case studies based on literature review of $> 1000$ scientific papers. The database describes regime shifts in terms of their alternative regimes, drivers, feedback mechanisms, impacts on ecosystem services, and management options. It provides a set of $75$ categorical variables about impacts, scales, and evidence types used to test our expectations (Table S2, see SM methods for processing of variables). The database consistently encodes regime shifts into causal diagrams as a graphical summary of the drivers and underlying feedbacks of each regime shift (Fig S1). Causal diagrams for each regime shift were converted into a network by creating the adjacency matrix $A$, where $A_{i,j}$ is $1$ if there is a connection or zero if not (SM Methods). A link between two nodes in these networks means that there is at least one scientific paper reviewed in the database providing some evidence for a causal relationship [@Rocha:2015du; @Biggs:2018hx].

Three response variables matrices were created by merging pairs of regime shift networks (Fig 1): (i) for driver sharing it is the number of co-occurring drivers, (ii) for domino effects it is the number of directed pathways that connect two regime shifts, and (iii) for hidden feedbacks it is the number of new cycles that emerge when joining two regime shift networks (Fig. 1, SM Methods). The hypotheses were tested using exponential random graph models (SM methods). In this framework, our research question can be rephrased as 'What is the likelihood of a link between regime shifts in the response variable matrix, and what features change this likelihood?' As explanatory variables we used the regime shift database categorical variables focusing on how similar two regime shifts are, and whether the similarity increases the likelihood of having a link on the response variable matrices (SM Method). The specification for the model follows a Poisson reference distribution [@Krivitsky:2012uo] given that the response variables contain weighted links of count data --- how many domino effects, hidden feedbacks, or shared drivers link pairs of regime shifts.

```{r Fig1, cache = TRUE, echo = FALSE, error=FALSE, warning=FALSE, message=FALSE, fig.height = 3.75, fig.width = 4.75, fig.align = 'center', fig.cap = "Method scheme. Pairs of regime shift causal networks were merged to create a response variable matrix that accounted for drivers shared, domino effects, or hidden feedbacks. In all examples two minimal regime shifts are depicted as causal diagrams, drivers are colored red and variables belonging to feedbacks purple. For driver sharing, the joint network is simplified as a two-mode network which allows us to study the co-occurrence of drivers (in red) across regime shifts (in blue). Driver 'a' is shared by regime shifts 1 and 2 but not driver 'b'. The response variable matrix counts the number of drivers shared by all pairwise combinations of regime shifts. For domino effects, two regime shift networks are joined together where driver 'c' in regime shift 2 is also part of a feedback process in regime shift 1, creating a one-way dependency (orange link) between the two regime shifts. The response variable matrix counts all the one-way causal pathways between pairwise combinations of regime shifts. For hidden feedbacks, two minimal regime shifts when joined together give rise to a new unidentified feedback (orange circular pathway). The response variable matrix counts all hidden feedbacks that arise when merging pair wise combinations of regime shifts. The 30 causal networks used and the labelled matrices of the resulting response variables are shown in Fig. S1 and S3.", dev = "pdf", dpi = 300, dev.args = list(pointsize = 6)}

knitr::include_graphics(path = "~/Documents/Projects/Cascading Effects/Figures/Cascading_Fig1.pdf")

```

## Results

Regime shifts can be structurally interdependent (Fig. 2). The three response variables combined show that ~45% of the regime shift couplings analyzed presents structural dependencies in the form of one-way interactions for the domino effect or two-way interactions for hidden feedbacks. While ~4% and 2% of the couplings present only domino effects and hidden feedbacks respectively, 28% of the pairwise combinations are linked through two different types of connections, and 10% by all three of them. Only for 19% of the pairwise combinations we can be certain with the current dataset that there is no cascading effects. However, the discovery of new drivers or feedback mechanisms underlying these dynamics can reduce this estimate.

```{r Fig2, cache = TRUE, echo = FALSE, error=FALSE, results = 'hide', warning=FALSE, message=FALSE, fig.height = 3, fig.width = 4.75, dev.args = list(pointsize= 6), fig.align='center', fig.cap = 'Regime shifts potential structural interactions. The three response variables combined (A) shows ', dev = "pdf", dpi = 300}

knitr::include_graphics(path = "~/Documents/Projects/Cascading Effects/Figures/Cascading_FigSummary.pdf")


# Driver sharing. The distribution of drivers shared per regime shift (a) with respect to the number of drivers each one has (black points) shows that regime shifts in aquatic environments tend to have and share more drivers. (b) shows the drivers most shared. WAIS abbreviates West Antarctica Ice Sheet collapse.

```
Driver sharing is the most common type of connection found (Fig. 2). Regime shifts can correlate in time and space due to common drivers, but they do not necessarily become interdependent[@Hughes:2013cv; @Rocha:2015du]; this is, the occurrence of one does not affect the probability of the second occurring. 35% of all pairwise regime shift combinations were coupled only by driver sharing. The resulting matrix for driver sharing describes the co-occurrence patterns of `r dim(bipmat)[1]` drivers across the `r dim(bipmat)[2]` regime shifts analyzed. In our sample, aquatic regime shifts tend to have and share more drivers, although the driver sharing is not exclusively with other aquatic regime shifts (Fig. 3A, 4B). The highest driver co-occurrence was found between regime shifts in kelps, marine eutrophication, the collapse of fisheries and hypoxia. Terrestrial and polar regime shifts tended to have fewer and more specific sets of drivers. Large-scale regime shifts in polar and sub-continental areas (e.g. Monsoon weakening) have fewer drivers but are hotspots of sharing, typically including climate-related drivers. Drivers that co-occurred most frequently were related to food production, climate change and urbanization, yet none of them is ubiquitous in our sample  (Fig. 3B).

In line with our expectations, regime shifts were more likely to share drivers when they occurred in similar land uses, but not necessarily under the same ecosystem types (p << 0.001, Fig. 4, Table S3). We did not expected cross-scale interactions in driver sharing, yet we found that it is more likely to share drivers in dynamics that are faster in time (from weeks to years), and when spatial scales match. We also tested whether regime shifts impacts on ecosystem services and human well-being was related to driver sharing and found that impacting similar regulating and provisioning services increase the likelihood of common drivers.


```{r Fig3, cache = TRUE, echo = FALSE, error=FALSE, results = 'hide', warning=FALSE, message=FALSE, fig.height = 6, fig.width = 4.75, dev.args = list(pointsize= 6), fig.align='center', fig.cap = '', dev = "pdf", dpi = 300}


knitr::include_graphics("~/Documents/Projects/Cascading Effects/Figures/Cascading_Fig2.pdf")

# Statistical models summary. The response variables are the matrices of regime shifts interconnections for each cascading effect type (Fig 1). The terms fitted correspond to the categorical variables from the regime-shifts database (Table S2) that capture the similarity of regime shifts regarding their impacts on ecosystem services and human well being, the scales at which they occur, reversibility and evidence type (See SM Methods). Results from exponential random graph models are interpreted similarly to those of logistic regression where the non-zero and sum terms are the equivalent of an intercept. The non-zero term is the likelihood of the existence of a link in the response variable network, while the sum corresponds to its weight. Only best models are shown (lowest AIC or BIC), for complete results of null and alternative models fitted see Tables S3, S4 and S5.



```

```{r Fig4, cache = TRUE, echo = FALSE, error=FALSE, results = 'hide', warning=FALSE, message=FALSE, fig.height = 6, fig.width = 4.75, dev.args = list(pointsize= 6), fig.align='center', fig.cap = '', dev = "pdf", dpi = 300}

## Domino effects. Regime shifts that produce most domino effects (high outdegree, shaded green area) are Earth system tipping points, while the regime shifts that receive the most (high indegree, orange shaded area) occur in aquatic and land-water interface (a); labels are plotted only for regime shifts where the maximum number of domino effects is found (4). Most variables associated with domino effects are related to climate and transport mechanisms (b). These variables are part of a feedback mechanism in one regime shift that are in turn drivers in another regime shift.

# Hidden feedbacks. Hidden feedbacks occur typically in terrestrial and Earth system regime shifts, (a) shows the distributions of hidden feedbacks and has been organised by higher to lower mean in the number of feedbacks. Boxplots are shown in log-scale after zero values have been removed. The variables most often involved in hidden feedbacks have high betweenness and closeness centralities (b) calculated on the network of all regime shifts in our sample (N = 30). These measures reveal the variables (labelled) that lie on most shorter pathways from all other variables in the network

knitr::include_graphics("~/Documents/Projects/Cascading Effects/Figures/Cascading_Fig3.pdf")
```

Evidence of cross-scale interactions for domino effects was only found in time but not in space. As expected, regime shifts producing domino effects have slow temporal dynamics and larger spacial scales, such as thermohaline circulation collapse, river channel change, monsoon weakening, and Greenland ice sheet collapse (Fig. 3C). On the other hand, regime shifts influenced by domino effects were often marine and occurred over shorter times and more localized spaces, such as mangrove transitions, kelp transitions, and transitions from salt marshes to tidal flats. The statistical models support this observation for temporal scales (Fig. 4, Table S4): regime shifts whose time scales were on the range of weeks to months are more likely to receive influence from regime shifts whose dynamics occurred on the scale of years to decades (p < 0.1), but we did not find evidence for spatial scales. Having domino effects was significantly associated with impacting similar regulating and provisioning services, and similar aspects of human well-being (p < 0.001), but the size of the effects are dwarfed by its rarity. The sparse response variable matrix (Fig 1) and the negative coefficient on the sum term in the statistical models (Table S4) shows that domino effects are not common, and when they do occur it is only through few pathways between regime shifts (the maximum was 4 in our sample). Key variables involved in domino effects were related to climate, nutrients and water transport (Fig. 3D).

Hidden feedbacks were expected to arise when regime shifts dynamics matched scales in space and time, yet we only found evidence of matching in space (Fig 4, Table S5). The statistical analysis shows that there were fewer hidden feedbacks that one would expect by chance, but when they did occur, they tend to couple regime shifts through multiple feedbacks. Most hidden feedbacks in our sample occurred in terrestrial and earth systems (Fig 3E, 4). The regime shifts with higher numbers of connections (16 to 18 out of 30 possible) are forest to savanna, monsoon weakening, thermohaline circulation, desertification, primary productivity of the Arctic Ocean and the Greenland ice sheet collapse. Key variables belonging to many hidden feedbacks were related to climate, fires, erosion, the functional role of herbivores, agriculture and urbanization (Fig 3F).

## Discussion

Regime shifts are ubiquitous in nature, yet how they can interact has reminded an unexplored question. While this question is fundamental for scientist forecasting the dynamics of ecosystems, the answers are relevant for policy makers and managers because regime shifts can impact ecosystem services, human well-being, and undermine the achievement of sustainable development goals. Domino effects and hidden feedbacks are often disregarded because research on regime shifts is divided by disciplines and typically focus on one system at the time. Consequently, data collection and hypothesis testing for coupled systems has largely remained unexplored [@Liu:2015go; @Hughes:2013cv]. While few studies have investigated cascading effects by looking at temperature driven tipping points in the climate systems [@Steffen:2018ku; @Dekker:2018jk], a growing body of literature has started to offer informed speculations on how different regime shifts can be interconnected (Table S1). Here we have developed a network based method that allow us to systematically identify potential cascading effects, and differentiate whether a regime shift coupling is expected to create structural dependencies in the form of domino effects or hidden feedbacks (Fig. 2).

Our findings align with previous results on the type of variables and processes that might couple regime shifts (See Table S1), highlighting the role of climate and transport mechanisms for nutrients and water (Fig. 3). Recent literature (refs. in Table S1) reports potential linkages between eutrophication and hypoxia, hypoxia and coral transitions, shifts in coral reefs and mangroves transitions, or climate interactions. Other examples in the terrestrial realm report potential increase in Arctic warming from higher fire frequency in boreal forest or permafrost thawing. Regime shifts in the Arctic can impact any temperature driven regime shift in and outside the Arctic [@Peterson:2016ul], including the weakening of the thermohaline circulation. Moisture recycling is a key underlying feedback on the shift from forest to savanna or the Indian monsoon; but also has the potential to couple ecosystems beyond the forest that depend on moisture recycling as an important water source. Changes in moisture recycling can affect mountain forest in the Andes, nutrient cycling in the ocean by affecting sea surface temperature and therefore regime shifts in marine food webs, or exacerbation of dry land related regime shifts.

Guided by the practice of explaining and modeling single regime shifts as emergent dynamics from fast and slow processes [@Crepin:2006ex; @Kuznetsov:2004vv; @Dekker:2018jk], we speculated that cascading effects between regime shift couplings were determined by cross-scale interactions. For domino effects we only found support of cross-scale interactions in time but not in space. For hidden feedbacks we expected matching in space and time but only found support for matching in space. Together, these results show that the likelihood of regime shift coupling depends on cross-scale interactions but it depends on the cascading effect type. Lack of evidence for interactions across spatial scales for domino effects, or temporal matching for hidden feedbacks, suggests that stochastic and transient dynamics might be playing a more important role on regime shift cascading effects [@Hastings:2018gy].


 Time correlation is debated given that spatial heterogeneity can break the synchrony induced by the sharing of drivers [@Hughes:2013cv], meaning that contextual settings matter for such correlations to emerge. Spatial heterogeneity has also been attributed as a mechanism that can smooth out critical transitions [@Martin:2015kl; @Medeiros:2016vf]. Yet identifying common drivers is useful for designing management strategies that target bundles of drivers instead of well-studied variables independently, increasing the chances that managers will avoid several regime shifts under the influence of the same sets of drivers [@Rocha:2015eea; @Rocha:2015du]. For example, management options for drivers such as sedimentation, nutrient leakage, and fishing can reduce the likelihood of regime shifts such as eutrophication and hypoxia in coastal brackish lagoons, as well as coral transitions in adjacent coral reefs.

While our method identifies plausible connections between regime shifts, identifying the conditions that change "plausible" to "probable" requires more detailed understanding on regime shifts mechanisms. Empirical studies and modelling syntheses are required to translate our identification of possible mechanisms into context-sensitive forecasts. Dynamic models of this type of dynamics require careful assumptions about parameter values as well as the functional form of the system's equations. Generalized modelling is a promising technique that does not require particular assumptions, allowing the researcher to reach more general conclusions based on stability properties of the system [@Gross:2009jr; @Lade:2013iwa]. Another potential avenue for future research is looking at how transport mechanisms couple physically distant ecosystems. One example already mentioned is the moisture recycling feedback [@Keys:2012bo]. Another important social connection (sensu [@Liu:2015go]) could be with allocation of resources through international trade, investigating how demand of resources in certain countries can shape the state space of ecosystems from the providing countries. An important lesson from our study is that regime shifts can be interconnected, they should not be studied in isolation under the assumption that they are independent systems. On the contrary, methods and data collection that takes into account the possibility of cascading effects needs to be further developed.

The frequency and diversity of regime shifts interconnections suggests that current approaches to environmental management and governance are substantially underestimating the likelihood of cascading effects. More attention should be paid to how the Earth is social-ecologically connected [@Liu:2015go], how those connections should be managed, and how to best prepare for regime shifts. Our research suggests that regional ecosystems can be transformed by ecosystem management far away, and conversely, can themselves drive the transformations of other distant ecosystems. Decisions made in one place can undermine the achievement of sustainable development goals in other places. For example, it has been shown that what happens in the Arctic does not stay in the Arctic [@Cvijanovic:2017hn; @Peterson:2016ul], many Arctic regime shifts have the potential to impact non-Arctic ecosystems far away and the provision of their ecosystem services. It implies that whoever does make decisions on management is not necessarily the one that has to deal with the impacts. This issue is evident in governance of water transport systems, whether run-off or atmospheric transport, but it is applicable to other dynamics connecting far-away ecosystems through other mechanisms such as climate change, fire, nutrient inputs or trade. Our results highlight variables that are key for domino effects and hidden feedbacks, e.g. ====== . They are also good observables for monitoring early warning indicators of the strengthening of regime-shifts coupling.

## Conclusions

Regime shifts occur across a wide range of ecosystems. However, how a regime shift somewhere in the world could affect the occurrence of another regime shift remains an open question and a key frontier of research. We propose two types of cascading effects that can connect different regime shifts: domino effects, and hidden feedbacks; and compare them with the case of driver sharing. To assess these cascading effects among regime shifts we developed a network-based method that identified plausible cascading effects. Regime shifts that occur in similar ecosystems and land uses are more likely to share drivers, and consequently respond similarly to environmental change. One-way directional interactions or _domino effects_ are common but not exclusive to aquatic regime shifts, such effects highlight the role of water transport and tend to emerge between regime shifts whose dynamics occur at similar temporal scales. Two-way interconnections or _hidden feedbacks_ are more common in terrestrial systems, they occur often between regime shifts that match spatial scales and impact similar ecosystem processes. How and when nonlinear change can be transmitted across space and time in the earth system should be considered in assessments of future environmental change and planning.


### Acknowledgements
We are grateful to the contributors, reviewers and developers of the regime shifts database. This work was supported by FORMAS grant 942-2015-731 to JR, and National Science Foundation grant OCE-1426746 to SL. JR designed the research, JR and GP curated the data, JR wrote the code and run the analysis with guidance from GP, ÖB and SL; JR, GP, ÖB and SL wrote the paper. Authors declare no competing interests. Data from the regime shifts database is publicly available at [www.regimeshifts.org](www.regimeshifts.org). Upon publication, the version of the database used, curated causal networks, and code will be made available in both the regime shifts database and an online repository (e.g. figshare or dryad). The development version of the code is available at: https://github.com/juanrocha/Domino


\pagebreak


## Supplementary material

: Summary of examples from the literature

| Regime shift 1 | Regime Shift 2 | Type | Reference |
|:--------------:|:--------------:|:--------------:|:--------------:|
| Marine eutrophication | Hypoxia | Sharing drivers, domino effect | [@Diaz:2008p199] |
| Hypoxia | Coral transitions | Domino effect | [@Altieri:2017bl] |
| Forest to savanna | Mountain forest transitions | Domino effect | [@Clark:2015bj; @MoruetaHolme:2015fy] |
| Forest to savanna | Marine food webs | Domino effect | [@Bakun:2010p5340] |
| Forest to savanna | Dryland degradation | Domino effect | [@DebraPCPeters:2004ex] |
| Coniferous to deciduous boreal forest | Arctic sea ice loss | Hidden feedback | [@Young:2016kj; @Kelly:2015iq] |
| Peatland transitions | Arctic sea ice loss | Hidden feedback | [@Zona:2016hq] |
| Arctic sea ice loss | Thermohaline circulation weakening | Hidden feedback | [@Sevellec:2017fk] |
| Antarctic sea ice loss | Marine food webs | Hidden feedback | [@Moore:2018ci] |
| Thermohaline circulation weakening | ENSO | Domino effect | [@Dekker:2018jk] |

### Supplementary methods:

This section complements the methods and results from the exponential random graph models. The modeling technique used the number of drivers shared, the number of domino effects and the number of hidden feedback as the three key response variables (Fig 1). The use of exponential random graph models is motivated because it take into account network structure and allow us to control for sample bias. It investigates the odds of the existence and weight of a link and its results are interpreted similarly to a logistic regression.

_Data_: The [regime shifts database](www.regimeshifts.org) synthesizes scientific literature on our current knowledge on regime shifts. It is an open online repository of regime shift syntheses and case studies. When possible, entries to the regime shifts database have been peer-reviewed by an expert on the topic to ensure quality and accuracy of its contents [@Biggs:2015iha]. The main data used in this study are the causal loop diagrams described in the database (Fig S1), and a set of categorical variables about regime shifts attributes that were used to fit statistical models to explore the role of cross scale interactions (described below). Out of the 35 regime shifts documented in the database, here we use 30 where complete synthesis exist and causal loop diagrams have been curated.

_Causal loop diagrams_ (CLDs) represent a collection of causal mechanisms that scientist have reported in their narratives: both empirical (what they choose to sample) or theoretical (what they choose to model). CLDs consist of variables connected by arrows denoting causal influence [@Sterman:2000we], also known as signed directed graphs. Each relationship must have a positive $(+)$ or negative $(-)$ sign that represents the effect of the dependent variable given change on the independent variable [@Lane:2008p6781; @Sterman:2000we]. Although the functional form that underlies each relationship is not necessarily known, positive relationships are proportional while negative ones are inversely proportional _ceteris paribus_. CLDs assume that the causal relationships captured by links are monotonic, while non-linearities are captured by links sets: thus they do not have self-loops. Feedback loops are the basic structural units of the diagram and emerge by connecting variables in closed directed paths (cycles). Feedback means that once a signal enters the loop, some part of the output is fed back to the input, resulting in amplification or dampening of its own signal. Feedbacks can be reinforcing if the overall polarity of its links is positive, or balancing if negative. Reinforcing feedbacks are usually responsible for behaviors that drive the system out of equilibrium, while balancing feedbacks are responsible for near equilibrium dynamics such as oscillations and delays [@Sterman:2000we]. Note that causal links do not describe the behavior of variables, only the structure of the system: they describe what would happen if there were changes [@Sterman:2000we]. CLDs were curated in the regime shifts database in a way that variables names are consistent (e.g. agriculture and cropping is kept as 'agriculture'), and feedback loops comparable (e.g. albedo in the rainforest, Arctic or Antarctic regime shifts is the same feedback). Fig S1 shows all CLD's used in the analysis.


```{r FigS1, cache = TRUE, echo = FALSE, error=FALSE, warning=FALSE, message=FALSE, fig.height = 10, fig.width = 10, dev.args = list(pointsize= 7), fig.align='center', fig.cap = 'Fig S1. Causal networks for all regime shifts analysed', fig.lp = ""}

## Updated ploting function
quartz(width = 8, height=6, pointsize= 9)
# detach(package:igraph)
library(network); library(sna)
# quartz(pointsize = 7)
par(mfrow = c(6,5), mar = c(0.25,0.25,1.25,0.25))

for (i in 1:length(levels(dat$Regime.Shift)) ){
	net <- rs.net(dat = dat,  i = i)
	plotnet(net)

}

# quartz.save("Cascading_FigS1_CLDs.png", type = "png", dpi = 800)

```

_Categorical variables:_ We calculated the similarity of each pair-wise combination of regime shifts in the database regarding categorical attributes (Table S2) such as *(i)* land use under which the regime shift occur, *(ii)* ecosystem type, impacts on *(iii)* ecosystem processes, *(iv)* provisioning services, *(v)* regulating services, *(vi)* cultural services, *(vii)* and human wellbeing; as well as *(viii)* the spatial scale at which the regime shift occur, *(ix)* the temporal scales, *(x)* reversibility, and *(xi)* evidence type [@Biggs:2015iha; @Rocha:2015du]. For all $75$ categorical variables encoded, the database reports presence or absence $(0,1)$ allowing us to calculate the Jaccard index and use it as a proxy of how similar two regime shifts are. To facilitate the interpretation of statistical models, the Jaccard distance was rescaled ($x =1 - J_{d}$) so equivalent regime shifts score 1 and complete dissimilar zero. Given that most of our hypotheses relate to the scale at which regime shifts occur, we also modelled scale as a categorical variable to account for matches in the network, not only similarity. Figure S2 shows a map with all generic types of regime shifts and case studies reported in the regime shifts database.



```{r table_2, cache = TRUE, echo = FALSE, error=FALSE, warning=FALSE, message=FALSE}
text_tbl <- data_frame(
    Terms = c("Land use", "Ecosystem type", "Ecosystem processes", "Provisioning services", "Regulating services", "Cultural services", "Impacts on human well being", "Spatial scale", "Temporal scale", "Reversibility", "Evidence type"),
    Explanation = c("Land use under which the regime shift occurs", "Ecosystem type in which the regime shift occurs", "Impacts on key ecosystem processes",
                    "Impacts on provisioning ecosystem services", "Impacts on regulating ecosystem services", "Impacts on cultural ecosystem services",
                    "Impacts on aspects of human well being", "Typical spatial scale at which the regime shift occurs",
                    "Typical time scale at which the regime shifts occurs", "Reversibility of the regime shift", "Evidence type in the literature"),
    Variables = c("Urban, small-scale subsistence crop cultivation, large-scale commercial crop cultivation,
                  intensive livestock production (eg feedlots, dairies), extensive livestock production (natural rangelands),
                  timber production, fisheries, mining, conservation,
                  tourism, land use impacts are primarily off-site)",
                  "Marine and coastal, freshwater lakes and rivers, temperate and boreal forests, tropical forests, moist savannas and woodlands, drylands and deserts (below ~500mm rainfall/year), mediterranean shrub (e.g. fynbos), grasslands, tundra, rock and ice, agro-ecosystems, planetary",
                  "Soil formation, primary production, nutrient cycling, water cycling, impacts on biodiversity",
                  "Freshwater, food crops, livestock, fisheries, wild animal and plant products, timber, woodfuel, feed fuel and fiber crops, hydropower",
                  "Air quality regulation, climate regulation, water purification, water regulation, regulation of soil erosion, pest and disease regulation, pollination, natural hazard regulation",
                  "Recreation, aesthetic values, knowledge and educational values, spiritual and religious",
                  "Food and nutrition, health (eg toxins, disease), livelihoods and economic activity, security of housing and infrastructure, aesthetic and recreational values, cultural identity, social conflict, no direct impact",
                  "Local/landscape (e.g. lake, catchment, community), national (country), sub-continental (e.g. southern Africa, Amazon basin), global",
                  "Weeks, months, years, decades, centuries, unknown",
                  "Irreversible (on 100 year time scale), hysteretic (difficult to reverse), readily reversible, unknown",
                  "Models, paleo-observation, contemporary observations, experiments, other")
)

kable(text_tbl, format = "latex", booktabs = TRUE,
      caption = "Summary of categorical variables") %>%
    kable_styling(full_width = TRUE, latex_options = c("scale_down", "HOLD_position"),
                  font_size = 8) %>%
    column_spec(3, width = "4in") #%>%
    # add_footnote(c("Source: the regime shifts database [www.regimeshifts.org]"), notation = "symbol")
```

```{r FigS2, cache = TRUE, echo = FALSE, error=FALSE, warning=FALSE, message=FALSE, fig.height = 4, fig.width = 6, fig.align = 'center', fig.cap = "Fig S2. Regime shifts around the world. Large points show generic types of regime shifts (n = 35) while small points are case studies (n=324).", dev.args = list(pointsize = 5), fig.lp = ""}

coords <- read.csv2("~/Documents/Projects/Cascading Effects/Domino/case_coords.csv", dec = '.')

coord_rs <- read.csv(file = '~/Documents/Projects/Cascading Effects/Domino/rs_coords.csv', dec = '.')
cases <- cbind(cases, coords)
rs <- cbind(rs, coord_rs)
rs$rs <- as.factor(rs$rs)
cases$Type.of.regime.shift <- as.factor(cases$Type.of.regime.shift)
names(cases)[7] <- 'rs'

# correction on RS names for plotting
levels(rs$rs) [17] <- "Marine food webs"
levels(rs$rs) [28] <- "Thermokarst lakes"
levels(cases$rs)[17] <- "Fisheries collapse"
levels(cases$rs)[c(5,22)] <- "Marine food webs"
levels(cases$rs)[c(2,9,12,17,20)] <- "Other"


world <- map_data('world')
world <- fortify(world)

m <- ggplot(world, aes(long, lat)) +
    geom_polygon(fill="grey90", aes(group = group)) +
    geom_path(color="white",aes(group=group), size = 0.2) +
    coord_equal() + theme_void(base_size = 7, base_family = "Helvetica")

m + geom_point(data = cases, aes(lon, lat, color = rs), size = 0.2, show.legend = F) +
    geom_point(data = rs, aes(lon,lat, color = rs), size = 2, show.legend = T ) +
    theme(legend.position = "bottom", legend.text = element_text(size = 4)) +
    scale_color_discrete(guide = guide_legend(title = "Regime shifts documented on the regime shifts database \n Source: www.regimeshifts.org", title.position = 'top', title.hjust = 0.5))

# png(file="rsdb_map.png", width=1280, height = 768, units = "px")
# dev.off()
# quartz.save("rsdb_map.png", width= 12, height=7, pointsize = 10, dpi = 800, bg = "white")

```

_Networks:_ Causal loop diagrams were reinterpreted as networks where node attributes were coded if a node belonged to a feedback loop -a k-cycle in the network- or not. The later is then by definition a driver, an independent variable whose dynamics are not affected by the dynamics of the state variables of the system at hand. Note that networks in ecology usually describe inter-species interactions such as predation or mutualism. Our approach is different from what has been done in ecology. Here a network describes a set of processes, both biotic and abiotic, that can govern ecosystem regime-shift dynamics. Our approach is inspired by other network applications to processes such as cell metabolic networks or the network of human diseases, where a process is not captured by a link type (e.g. predation) but by a collection of link interactions (e.g. the Krebs cycle). Thus, individual species are not taken into consideration, but rather their functional roles at the aggregated ecosystem scale (e.g. herbivory).

_Shared drivers:_ To study shared drivers we created a bipartite network of drivers and regime shifts following the method outlined by Rocha et al [@Rocha:2015du]. The statistical models were performed for the case of driver sharing on the one-mode network projection of regime shifts sharing drivers (this is the matrix $A^TA$), and categorical variables from the regime-shifts database were used as node attributes or node covariates to test our hypothesis.

_Domino effects:_ occur when the occurrence of a regime shift can increase or decrease the likelihood of other regime shifts occurring, creating a one-way dependence. Different from the driver-sharing network, here we explore potential domino effects by using the full causal loop diagrams as networks. The algorithm for identifying domino effects takes the adjacency matrix of two given regime shifts $A_1$ and $A_2$ and identifies all nodes $n \in A_1 \cap A_2$ such that $n$ belong to a feedback in $A_1$ but is a driver in $A_2$. Thus, set differences between causal pathways suggest missing drivers, and set intersection between causal pathways and feedback loop nodes indicate potential domino effects (Fig. 2b). By iterating this simple algorithm we derived how many different pathways exist between every pair-wise combination of regime shifts $(N=870)$. The resulting non-symmetrical matrix represents a directed network with regime shifts as nodes and link weights as the number of pathways used for statistical analysis.

_Hidden feedbacks:_ We explore hidden feedbacks by pair-wise comparison of causal networks. First, the feedback loops (or k-cycles) are counted by feedback length $k$ for each regime shift matrix  $A_1$ and $A_2$ separately. Then the cycle count is applied to the composite network $A_{1,2}$ of the two regime shifts. The difference between the k-cycles in the composite network $A_{1,2}$ and the k-cycles in the individual networks $A_1$ and $A_2$ are the hidden feedbacks that emerge when the two causal networks are joined. By iterating the same procedure to all pair-wise combinations of regime shifts $(N=435)$ we obtain a symmetric directed matrix that is then used for the statistical analysis. Although computationally intensive, the search for cycles is feasible in our networks given the small size and relative sparse structures. In fact, the maximum cycle length $k$ is bounded by the size of the network. Out of the `r length(out_inc)` coupled networks analysed, the maximum feedback length was `r unlist(lapply(out_inc, network.size) ) %>% max`.

```{r matrixes_fig, cache = TRUE, echo = FALSE, error=FALSE, warning=FALSE, message=FALSE, fig.height = 7, fig.width = 7, dev.args = list(pointsize= 6), fig.align='left', fig.cap = 'Fig S3. Response variable matrices and summary of all cascading effects in matrix form.', dev = "pdf", dpi = 300, fig.lp = ""}


df_fork <- as.sociomatrix(x, "paths") %>% as_tibble() %>% mutate(tail = rownames(as.sociomatrix(x))) %>%
        gather(key = head, value = drivers,  1:30) %>% mutate(tail = as.factor(tail) %>% forcats::fct_rev()) %>%
    mutate(drivers = ifelse(drivers > 0, 1, 0))
# domino <- as.sociomatrix(dom_net)
# inconvenient <- as.sociomatrix(inc_net)

# inconvenient <- cbind(inconvenient, rep(0,29))
# inconvenient <- rbind(inconvenient, rep(0,30))
#
# colnames(inconvenient)[30] <- "Sprawling vs compact city"
# rownames(inconvenient)[30] <- "Sprawling vs compact city"
#
# inconvenient <- clean.and.order(inconvenient)

# all <- as.data.frame(fork + domino + inconvenient)
# all$from <- rownames(all)
# df_all <- gather(all,  1:30, key = to, value = count)


df_domino <- as_tibble(out) %>% rename(tail = Tail, head = Head) %>%
    mutate(domino = ifelse(weight > 0, 1, 0)) %>% select(-driv2feed, -weight)
df_hidden <- as_tibble(df_inc3) %>% rename(tail = Tail, head = Head) %>%
    mutate(hidden = ifelse(inc > 0, 1, 0)) %>% select(-inc)


df_all <- left_join(df_fork, df_domino) %>% left_join(df_hidden) %>%
    group_by(tail,head) %>%
    mutate(all = sum(drivers, domino, hidden),
           type = ifelse(is.na(all), NA,
                         ifelse(all == 3, "all",
                                ifelse(all == 2, "multiple",
                                       ifelse(all == 1 && drivers == 1, "drivers sharing",
                                              ifelse(all == 1 && domino == 1, "domino effect",
                                                     ifelse(all == 1 && hidden == 1, "hidden feedback", NA)
                                                     )
                                              )
                                       )
                                )
           )
    )

df_all$type <- as.factor(df_all$type) %>% forcats::fct_relevel(
    "drivers sharing", "domino effect", "hidden feedback", "multiple", "all") %>%
    forcats::fct_rev() # %>%
    #fct_collapse(multiple = c('all', 'multiple')) #%>%
    # fct_explicit_na(na_level = "other") %>%
    # fct_collapse(other = c("drivers sharing", "other"))

m4 <- df_all %>% ungroup() %>% # filter(fork == 1, domino ==0, inc ==0) %>%
    mutate(tail = as.factor(tail) %>% forcats::fct_rev(),
               head = as.factor(head)) %>% #%>% forcats::fct_rev()),
    ggplot(aes(y = tail, x = head)) +
    geom_tile(aes(fill= type)) +
    scale_fill_brewer(type = "seq", palette = "YlOrBr", direction = -1, na.value = "gray57",
                      guide = guide_legend(title = "Cascading effects", barwidth = 0.5)) +
    theme_light(base_size = 6) + xlab('') + ylab('') + ggtitle("Summary matrix") +
    theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5 ),
          legend.position = "bottom")


lay <- rbind(c(1,1,2,2),
             c(NA,3,3,NA))
grid.arrange(m1,m2,m3,m4, layout_matrix = matrix(1:4,2,2, byrow = T))

```


### Exponential random graph models
The coefficients in exponential random graph models present the log-odds of the existence of a link given the similarites (Jaccard distances) or matching of node attributes (e.g. scale). Thus, their results are read similarly to those of a logistic regression. Instead of the intercept here we have the `nonzero` term which indicates what the odds are of the existence of a link. Since the networks are weighted by the number of shared drivers, domino effects or hidden feedbacks, the term `sum` accounts for the weight of the link when it exists. We used Jaccard similarity on the attributes coded in the regime shifts database to quantify how similar two regime shifts are and how the similarity affects the odds of a link. Since our hypotheses were related to the temporal and spatial scales at which the regime shifts occurred, we also modeled such terms not only as similarity (a score between 0 and 1), but also as categorical mutually exclusive variables. The original data from the regime shifts database coded for categorical non-exclusive variables. For spatial scale, when two different categories where present (e.g. local, national), we choose the larger category as the unique factor. For temporal scales, regime shifts were often coded as belonging to two categories (e.g. decades and centuries), thus we create a variable `time-range` that bundles both minimum and maximum reported. Spatial and temporal scales are then also modelled as factors too, the term `nodefactor` in each model accounts for how more likely is to have a link when the factor is present, while the `nodematch` term accounts for the homogeneity effect of two nodes sharing the same node attribute (same scale). The analysis was performed in R statistical language [@RCoreTeam:2012wf] using packages for modeling networks with exponential random graph models [@Handcock:2008p5095; @Hunter:2008vh; @Morris:2008ty; @Hunter:2007bq].

\pagebreak

**Table S3.** Exponential random graph models for \textit{shared drivers}
```{r tableSM2, message = FALSE, warning = FALSE, echo = FALSE, results='asis'}

suppressMessages(stargazer::stargazer(fit.null1, fit.w1, fit.w1a,
    align = F, header = F, type = 'latex', digits = 2,
    float = F, no.space = T, single.row = T, font.size = "footnotesize",
    title = "Table S2. Exponential random graph models for shared drivers (\textit{number of drivers shared})",
    covariate.labels = c("Non-zero", "Sum", "Land use", "Ecosystem type", "Ecosystem processes",
                         "Provising services", "Regulating services", "Cultural services",
                         "Human wellbeing", "Spatial scale: National",
                         "Spatial scale: sub-continental", "Temporal scale: month-year",
                         "Temporal scale: week-month", "Temporal scale: year-decade", "Spatial scale match",
                         "Temporal scale match", "Spatial scale similarity", "Temporal scale similarity",
                         "Reversibility",
                         "Evidence type"),
    dep.var.labels = "Shared drivers",
    add.lines = list(c("Maximum likelihood estimation",
                       round(fit.null1$mle.lik,2),
                       round( fit.w1$mle.lik,2),
                       round(fit.w1a$mle.lik,2))))
    )

```

\pagebreak

**Table S4.** Exponential random graph models for \textit{domino effects}
```{r tableSM3, message = FALSE, warning = FALSE, echo = FALSE, results='asis'}
suppressMessages(stargazer::stargazer( fit.null2, fit.w2, fit.w2a, fit.w2b,
    align = F, header = F, type = 'latex', digits = 2,
    float = F, no.space = T, single.row = T, font.size = "footnotesize",
    title = "Table S3. Exponential random graph models for \textit{domino effects}",
    covariate.labels = c("Non-zero", "Sum", "Land use", "Ecosystem type", "Ecosystem processes",
                         "Provising services", "Regulating services", "Cultural services",
                         "Human wellbeing",
                         "Spatial scale similarity", "Temporal scale similarity",
                         "Spatial scale: national", "Spatial scale: sub-continental",
                         "Temporal scale: year", "Temporal scale: month", "Temporal scale: decade",
                         "Indegree when spatial scale national", "Indegree when spatial scale subcontinental",
                         "Indegree when temporal scale year", "Indegree when temporal scale month",
                         "Indegree when temporal scale decade", "Outdegree when spatial scale national",
                         "Outdegree when spatial scale subcontinental", "Outdegree when temporal scale year",
                         "Outdegree when temporal scale month", "Outdegree when temporal scale decade",
                         "Spatial scale match: local", "Spatial scale match: national",
                         "Spatial scale match: sub-continental", "Temporal scale match",
                         "Reversibility",
                         "Evidence type"),
    dep.var.labels = "Domino effects",
     add.lines = list(c("Maximum likelihood estimation",
                       round(fit.null2$mle.lik,2),
                       round( fit.w2$mle.lik,2),
                       round(fit.w2a$mle.lik,2),
                       round(fit.w2b$mle.lik,2))))
    )
```

\pagebreak

**Table S5.** Exponential random graph models for \textit{hidden feedbacks}
```{r tableSM4, message = FALSE, warning = FALSE, echo = FALSE, results='asis'}
suppressMessages(stargazer::stargazer(fit.null3, fit.w3, fit.w3a,
    align = F, header = F,  type = 'latex', digits = 2,
    float = F, no.space = T, single.row = T, font.size = "footnotesize",
    title = "Table S4. Exponential random graph models for \textit{hidden feedbacks}",
    covariate.labels = c("Non-zero", "Sum", "Land use", "Ecosystem type", "Ecosystem processes",
                         "Provising services", "Regulating services", "Cultural services",
                         "Human wellbeing", "Spatial scale", "Temporal scale",
                         "Spatial scale: national", "Spatial scale: sub-continental",
                         "Temporal scale: year", "Temporal scale: month", "Temporal scale: decade",
                         "Spatial scale match", "Temporal scale match",
                         "Reversibility",
                         "Evidence type"),
    dep.var.labels = "Hidden feedbacks",
    add.lines = list(c("Maximum likelihood estimation",
                       round(fit.null3$mle.lik,2),
                       round( fit.w3$mle.lik,2),
                       round(fit.w3a$mle.lik,2))))
    )
```


\pagebreak
